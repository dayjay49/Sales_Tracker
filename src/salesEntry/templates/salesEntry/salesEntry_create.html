{% extends 'base.html' %} {% load static %} {% block content %}

<form
  id="sales-form"
  method="POST"
  action=""
  load-price-url="{% url 'ajax_load_price' %}"
>
  {% csrf_token %}
  <h3>Please choose staff and the sales he/she has made</h3>
  <div>
    {{salesEntryForm.as_p}}
  </div>
  {{ formset.management_form }}
  <div class="form-set">
    {% for form in formset %} {{form.non_field_errors}} {{form.errors}}
    <div class="dynamic-form" id="{{ form.id.auto_id }}">
      {{ form.as_table }}
    </div>
    {% endfor %}
  </div>
  <br />
  <div class="row spacer">
    <div class="col-4 offset-2">
      <button type="submit" class="submit-sales-entry">
        Save Entry
      </button>
    </div>
  </div>
</form>

<br />
<div>
  The total price of orders in current entry:
  <input class="entry-total-price" value="" disabled />
</div>

<script
  src="{% static 'js/jquery.formset.js' %}"
  type="text/javascript"
></script>

<script type="text/javascript">
  $(function () {
    $(".dynamic-form").formset({
      prefix: "{{ formset.prefix }}",
    });
  });
</script>

<!-- <script>
  function getDrinkPrice(drink_name) {
    var url = $("#sales-form").attr("load-price-url"); // get url of the 'load_price' view
    // initialize AJAX request
    $.ajax({
      url: url,
      data: {
        lemonade: drink_name, // add drink_id to GET parameter
      },
      success: function (price) {
        // `price` is data returned by 'load_price' view
        $("#id_saleEntry-");
      },
    });
  }
</script> -->

{% endblock %}
